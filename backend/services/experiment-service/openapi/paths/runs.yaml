run:
  get:
    tags: [runs]
    summary: Get run
    operationId: getRun
    parameters:
      - $ref: ../components/parameters.yaml#/RunId
    responses:
      200:
        description: Run
        content:
          application/json:
            schema:
              $ref: ../components/schemas.yaml#/Run
  patch:
    tags: [runs]
    summary: Update run
    operationId: updateRun
    parameters:
      - $ref: ../components/parameters.yaml#/RunId
    requestBody:
      required: true
      content:
        application/json:
          schema:
            $ref: ../components/schemas.yaml#/RunUpdate
    responses:
      200:
        description: Run updated
        content:
          application/json:
            schema:
              $ref: ../components/schemas.yaml#/Run

batchStatus:
  post:
    tags: [runs]
    summary: Batch status update
    operationId: batchUpdateRunStatus
    requestBody:
      required: true
      content:
        application/json:
          schema:
            $ref: ../components/schemas.yaml#/RunBatchStatusRequest
    responses:
      200:
        description: Updated runs
        content:
          application/json:
            schema:
              type: object
              properties:
                runs:
                  type: array
                  items:
                    $ref: ../components/schemas.yaml#/Run

captureSessions:
  get:
    tags: [capture_sessions]
    summary: List capture sessions
    operationId: listCaptureSessions
    parameters:
      - $ref: ../components/parameters.yaml#/RunId
      - $ref: ../components/parameters.yaml#/ProjectIdQuery
    responses:
      200:
        description: Capture session list
        content:
          application/json:
            schema:
              type: array
              items:
                $ref: ../components/schemas.yaml#/CaptureSession
  post:
    tags: [capture_sessions]
    summary: Start capture session
    operationId: createCaptureSession
    parameters:
      - $ref: ../components/parameters.yaml#/RunId
      - $ref: ../components/parameters.yaml#/ProjectIdQuery
    requestBody:
      required: true
      content:
        application/json:
          schema:
            $ref: ../components/schemas.yaml#/CaptureSessionCreate
    responses:
      201:
        description: Capture session created
        content:
          application/json:
            schema:
              $ref: ../components/schemas.yaml#/CaptureSession

captureSessionStop:
  post:
    tags: [capture_sessions]
    summary: Stop capture session
    operationId: stopCaptureSession
    parameters:
      - $ref: ../components/parameters.yaml#/RunId
      - $ref: ../components/parameters.yaml#/SessionId
      - $ref: ../components/parameters.yaml#/ProjectIdQuery
    responses:
      200:
        description: Stopped

captureSessionDelete:
  delete:
    tags: [capture_sessions]
    summary: Delete capture session
    operationId: deleteCaptureSession
    parameters:
      - $ref: ../components/parameters.yaml#/RunId
      - $ref: ../components/parameters.yaml#/SessionId
      - $ref: ../components/parameters.yaml#/ProjectIdQuery
    responses:
      200:
        description: Deleted

metrics:
  post:
    tags: [metrics]
    summary: Ingest metrics
    operationId: ingestMetrics
    parameters:
      - $ref: ../components/parameters.yaml#/RunId
      - $ref: ../components/parameters.yaml#/ProjectIdQuery
    requestBody:
      required: true
      content:
        application/json:
          schema:
            $ref: ../components/schemas.yaml#/MetricIngestRequest
    responses:
      202:
        description: Accepted
  get:
    tags: [metrics]
    summary: Query metrics
    operationId: queryMetrics
    parameters:
      - $ref: ../components/parameters.yaml#/RunId
      - $ref: ../components/parameters.yaml#/ProjectIdQuery
      - name: name
        in: query
        schema:
          type: string
      - name: from_step
        in: query
        schema:
          type: integer
      - name: to_step
        in: query
        schema:
          type: integer
    responses:
      200:
        description: Metrics
        content:
          application/json:
            schema:
              $ref: ../components/schemas.yaml#/MetricQueryResponse

artifacts:
  post:
    tags: [artifacts]
    summary: Create artifact
    operationId: createArtifact
    parameters:
      - $ref: ../components/parameters.yaml#/RunId
    requestBody:
      required: true
      content:
        application/json:
          schema:
            $ref: ../components/schemas.yaml#/ArtifactCreate
    responses:
      201:
        description: Artifact created
        content:
          application/json:
            schema:
              $ref: ../components/schemas.yaml#/Artifact
  get:
    tags: [artifacts]
    summary: List artifacts
    operationId: listArtifacts
    parameters:
      - $ref: ../components/parameters.yaml#/RunId
    responses:
      200:
        description: Artifacts
        content:
          application/json:
            schema:
              type: array
              items:
                $ref: ../components/schemas.yaml#/Artifact

artifactApprove:
  post:
    tags: [artifacts]
    summary: Approve artifact
    operationId: approveArtifact
    parameters:
      - $ref: ../components/parameters.yaml#/RunId
      - $ref: ../components/parameters.yaml#/ArtifactId
    responses:
      200:
        description: Approved

