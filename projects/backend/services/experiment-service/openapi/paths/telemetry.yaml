ingest:
  post:
    tags: [telemetry]
    summary: Ingest telemetry
    operationId: ingestTelemetry
    parameters:
      - name: Authorization
        in: header
        required: true
        description: Bearer sensor token issued on registration
        schema:
          type: string
    requestBody:
      required: true
      content:
        application/json:
          schema:
            $ref: ../components/schemas.yaml#/TelemetryIngestRequest
    responses:
      202:
        description: Accepted
      400:
        description: Validation or scope error
      401:
        description: Invalid sensor token
      404:
        description: Related entity not found

stream:
  get:
    tags: [telemetry]
    summary: Stream telemetry records (SSE)
    description: >
      Server-Sent Events stream for telemetry records. In the default deployment this is served by
      telemetry-ingest-service behind auth-proxy at the same path.
    operationId: telemetryStream
    parameters:
      - name: Authorization
        in: header
        required: true
        description: Bearer sensor token (or user JWT via auth-proxy)
        schema:
          type: string
      - name: sensor_id
        in: query
        required: true
        schema:
          type: string
          format: uuid
      - name: since_id
        in: query
        required: false
        schema:
          type: integer
          default: 0
      - name: max_events
        in: query
        required: false
        schema:
          type: integer
          nullable: true
      - name: idle_timeout_seconds
        in: query
        required: false
        schema:
          type: number
          default: 30
    responses:
      200:
        description: OK (text/event-stream)
        content:
          text/event-stream:
            schema:
              type: string

